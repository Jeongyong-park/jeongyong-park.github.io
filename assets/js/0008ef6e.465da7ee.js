"use strict";(self.webpackChunkjeongyong_park_github_io=self.webpackChunkjeongyong_park_github_io||[]).push([[377],{6840:e=>{e.exports=JSON.parse('{"permalink":"/blog/2017/01/09/post","source":"@site/blog/2017-01-09-post/index.md","title":"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95","description":"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95","date":"2017-01-09T00:00:00.000Z","tags":[{"inline":true,"label":"dotnet","permalink":"/blog/tags/dotnet"}],"readingTime":2.87,"hasTruncateMarker":false,"authors":[{"name":"Jeongyong Park","title":"\uc30d\ud314\ub144\uc0dd \uac1c\ubc1c\uc790","url":"https://github.com/jeongyong-park","email":"kladess@gmail.com","socials":{"x":"https://x.com/chisquare88","github":"https://github.com/jeongyong-park"},"imageURL":"https://github.com/jeongyong-park.png","key":"jypark","page":null}],"frontMatter":{"title":"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95","description":"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95","authors":["jypark"],"tags":["dotnet"],"image":"csharp.png","hide_table_of_contents":false},"unlisted":false,"prevItem":{"title":"Docker\ub97c \uc774\uc6a9\ud558\uc5ec gdal \uc0ac\uc6a9\ud558\uae30","permalink":"/blog/2021/05/22/post"}}')},7374:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var a=t(6840),r=t(4848),o=t(8453);const s={title:"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95",description:"C#\uc5d0\uc11c Thread\ub0b4\uc5d0 Parallel.Foreach \uac00 \uc788\ub294 \uacbd\uc6b0 \uc911\ub2e8 \ubc29\ubc95",authors:["jypark"],tags:["dotnet"],image:"csharp.png",hide_table_of_contents:!1},i=void 0,l={authorsImageUrls:[void 0]},c=[{value:"\uba54\uc778 \ud074\ub798\uc2a4 \ubc0f \uc911\ub2e8 \ud074\ub798\uc2a4",id:"\uba54\uc778-\ud074\ub798\uc2a4-\ubc0f-\uc911\ub2e8-\ud074\ub798\uc2a4",level:3},{value:"\uc2dc\uac04\uc774 \uc624\ub798\uac78\ub9ac\ub294 \uc791\uc5c5 \ud074\ub798\uc2a4",id:"\uc2dc\uac04\uc774-\uc624\ub798\uac78\ub9ac\ub294-\uc791\uc5c5-\ud074\ub798\uc2a4",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"GUI \ud658\uacbd\uc5d0\uc11c \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\ub294 \ub4f1\uc758 \uc774\ubca4\ud2b8\ub85c \uc2dc\uac04\uc774 \uc624\ub798 \uac78\ub9ac\ub294 \uc791\uc5c5\uc744 \uad6c\ub3d9\ud558\ub294 \uacbd\uc6b0 \uc2a4\ub808\ub4dc\ub97c \ubd84\ub9ac\ud558\uc5ec \uac1c\ubc1c\ud558\ub294 \ubc29\ubc95\uc774 \uc88b\ub2e4\ub294 \ubc29\ubc95\uc740 C# \ubfd0\ub9cc \uc544\ub2c8\ub77c \uc548\ub4dc\ub85c\uc774\ub4dc\ub098 MFC \ub4f1 GUI\ub97c \uc5b4\ub290 \uc815\ub3c4 \uac1c\ubc1c\ud55c \uc0ac\ub78c\uc774\ub77c\uba74 \uc775\uc219\ud558\ub9ac\ub77c \uc0dd\uac01\ud55c\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:"\uadf8\ub807\ub2e4\uba74 \uadf8 \uc2dc\uac04\uc774 \uc624\ub798 \uac78\ub9ac\ub294 \uc791\uc5c5\uc744 \ub354\uc6b1\ub354 \ube60\ub974\uac8c \ud558\uace0 \uc2f6\ub2e4\uba74 \ubcd1\ub82c \ucc98\ub9ac\uac00 \uac00\uc7a5 \uc27d\uace0 \ube68\ub9ac \uc801\uc6a9\ud560 \uc218 \uc788\ub294 \ud569\ub9ac\uc801\uc778 \ubc29\ubc95\uc774\ub77c\uace0 \uc0dd\uac01\ud55c\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:'\uad6c\uae00\ub9c1\uc744 \ud1b5\ud558\uc5ec \uc5b4\ucc0c\uc5b4\ucc0c \ubcd1\ub82c For \ubb38\uc744 \uc801\uc6a9\ud558\uc600\uc9c0\ub9cc, \ubb38\uc81c\ub294 "\ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uad6c\ub3d9\uc740 \ud588\uc9c0\ub9cc \uc624\ub798 \uac78\ub9ac\ub294 \ud504\ub85c\uc138\uc2a4\ub97c \uc791\uc5c5 \ub3c4\uc911\uc5d0 \uc911\ub2e8\ud558\uace0 \uc2f6\ub2e4"\ub77c\uace0 \ub9d0\ud588\uc744 \ub54c \ubc1c\uc0dd\ud558\uc600\ub2e4.'}),"\n",(0,r.jsxs)(n.p,{children:["\ub2e4\uc74c\uc740 \uba87 \uac00\uc9c0 \ucf54\ub4dc\ub97c \uc870\ud569\ud558\uc5ec \ub9cc\ub4e0 \uba54\uc778 \uc2a4\ub808\ub4dc\uc640 \ubd84\ub9ac\ub41c \ub2e4\uc911 \ud3ec\ubb38 \uc791\uc5c5 \ud074\ub798\uc2a4\uc640 \uadf8 \uc791\uc5c5\uc744 \uc911\ub2e8\uc2dc\ud0a4\ub294 \uc608\ub97c \ucf58\uc194 \uc751\uc6a9\ud504\ub85c\uadf8\ub7a8\uc73c\ub85c \uad6c\uc131\ud558\uc600\ub2e4.\n",(0,r.jsx)(n.sup,{children:(0,r.jsx)(n.a,{href:"#user-content-fn-1-afd254",id:"user-content-fnref-1-afd254","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),"\n",(0,r.jsx)(n.h3,{id:"\uba54\uc778-\ud074\ub798\uc2a4-\ubc0f-\uc911\ub2e8-\ud074\ub798\uc2a4",children:"\uba54\uc778 \ud074\ub798\uc2a4 \ubc0f \uc911\ub2e8 \ud074\ub798\uc2a4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nnamespace ThreadTest\n{\nclass Program\n{\nstatic void Main(string[] args)\n{\nConsole.WriteLine("press any key for Thread start!");\nConsole.ReadKey();\n\n            RulyCanceler canceler = new RulyCanceler();\n            TestFilter tf = new TestFilter(10000000);\n\n            Thread t = new Thread(() =>\n            {\n                try\n                {\n                    tf.execute(canceler);\n                }catch(OperationCanceledException)\n                {\n                    Console.WriteLine("Canceled!");\n                }\n            });\n            t.Start();\n            Console.ReadKey();\n            Console.WriteLine("Abort!");\n\n            canceler.Cancel();\n            t.Abort();\n            t.Join();\n\n            Console.WriteLine("Aborted!");\n            Console.ReadKey();\n\n        }\n    }\n    public class RulyCanceler\n    {\n        object _cancelLocker = new object();\n        bool _cancelRequest;\n        public bool IsCancellationRequested\n        {\n            get { lock (_cancelLocker) return _cancelRequest; }\n        }\n\n        public void Cancel() { lock (_cancelLocker) _cancelRequest = true; }\n\n        public void ThrowIfCancellationRequested()\n        {\n            if (IsCancellationRequested) throw new OperationCanceledException();\n        }\n    }\n\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uc2dc\uac04\uc774-\uc624\ub798\uac78\ub9ac\ub294-\uc791\uc5c5-\ud074\ub798\uc2a4",children:"\uc2dc\uac04\uc774 \uc624\ub798\uac78\ub9ac\ub294 \uc791\uc5c5 \ud074\ub798\uc2a4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nnamespace ThreadTest\n{\npublic class TestFilter\n{\nprivate long featureCount;\nprivate int MULTI_THREAD_COUNT = 10;\n\n        EventWaitHandle waitEvent = new EventWaitHandle(true, EventResetMode.AutoReset, "SHARED_BY_ALL_PROCESSES");\n        public TestFilter(long featurecount)\n        {\n            this.featureCount = featurecount;\n        }\n\n        public void execute(RulyCanceler cancer)\n        {\n            int workingRangeSize = 1;\n            if (featureCount > 100)\n            {\n                workingRangeSize = (int)(featureCount / MULTI_THREAD_COUNT);\n            }\n            var part = Partitioner.Create(0, featureCount, workingRangeSize);\n            Parallel.ForEach(part, (num, state) =>\n            {\n                for (long featureIdx = num.Item1, cnt = num.Item2; featureIdx < cnt; featureIdx++)\n                {\n                    try\n                    {\n\n                        //waitEvent.WaitOne();(\ud30c\uc77c \uc4f0\uae30\ubaa8\ub4dc\uc77c \uacbd\uc6b0 \ud558\ub098\uc758 \uc2a4\ub808\ub4dc\ub9cc \uc4f8\uc218 \uc788\ub3c4\ub85d \uc904\uc138\uc6b0\uae30)\n                        //waitEvent.Set();\n\n                        // \uc911\ub2e8 \uc694\uccad\uc774\uc788\uc73c\uba74 Throw\n                        cancer.ThrowIfCancellationRequested();\n\n                        // \uc2e4\uc81c \uc77c\n                        Console.WriteLine(String.Format("{0} - {1}", num.Item1, featureIdx));\n                    }\n                    catch (OperationCanceledException ex)\n                    {\n                        Console.WriteLine("Breaked.");\n                        Console.WriteLine("Clean");\n                        state.Break();\n                        break;\n\n                    }\n                }\n            });\n        }\n    }\n\n}\n'})}),"\n","\n",(0,r.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,r.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{id:"user-content-fn-1-afd254",children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"http://www.albahari.com/threading/part3.aspx",children:"http://www.albahari.com/threading/part3.aspx"})," ",(0,r.jsx)(n.a,{href:"#user-content-fnref-1-afd254","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>i});var a=t(6540);const r={},o=a.createContext(r);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);